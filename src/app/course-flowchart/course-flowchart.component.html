<div class="min-h-screen flex flex-col bg-tertiary md:pb-24 xl:pb-14">
  @if (courses) {
    <div
      class="flex-1 overflow-auto grid grid-cols-1 xl:grid-cols-3 gap-0 font-tmcandor dark:font-orbi text-secondary dark:text-tertiary">
      <!-- Phase 1 (Year 1) -->
      <div class="bg-bgLightest dark:bg-gray-900 group">
        <div class="p-10 bg-primary text-tertiary dark:bg-secondary relative overflow-hidden transition-colors duration-500 ease-in-out">
          <img
            src="/assets/patterns/checkered-secondary.svg"
            alt="TM Checkered Background"
            class="absolute inset-0 w-full h-full object-cover scale-105 z-0 opacity-0 group-hover:opacity-100 group-hover:scale-110 transition-opacity-transform duration-500 ease-in-out dark:hidden"
          >
          <img
            src="/assets/patterns/circles-dark.svg"
            alt="TM Circles Background"
            class="absolute inset-0 w-full h-full object-cover scale-105 z-0 opacity-0 group-hover:opacity-100 group-hover:scale-110 transition-opacity-transform duration-500 ease-in-out hidden dark:block"
          >
          <h1 class="font-bold text-2xl text-center relative">🔍 Year 1 (Phase 1)</h1>
        </div>
        <div class="grid grid-cols-2 gap-4 p-8">
          <!-- Semester 1 -->
          <div class="col-span-1">
            <h2 class="font-extrabold text-lg text-center mb-2">Semester 1</h2>
            @for (course of getCourses(1, 1);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>

          <!-- Semester 2 -->
          <div class="col-span-1">
            <h2 class="font-extrabold text-lg text-center mb-2">Semester 2</h2>
            @for (course of getCourses(1, 2);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>

          <!-- Semester 3 -->
          <div class="col-span-2">
            @for (course of getCourses(1, 3);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>
        </div>
      </div>

      <!-- Phase 2 (Year 2) -->
      <div class="bg-bgSoft dark:bg-bgGrayDark group">
        <div
          class="p-10 bg-primaryDark text-tertiary dark:bg-secondaryDark relative overflow-hidden group-hover:bg-primary dark:group-hover:bg-secondaryDark transition-colors duration-500 ease-in-out">
          <img
            src="/assets/patterns/checkered-secondary.svg"
            alt="TM Checkered Background"
            class="absolute inset-0 w-full h-full object-cover scale-105 z-0 opacity-0 group-hover:opacity-100 group-hover:scale-110 transition-opacity-transform duration-500 ease-in-out dark:hidden"
          >
          <img
            src="/assets/patterns/circles-dark.svg"
            alt="TM Circles Background"
            class="absolute inset-0 w-full h-full object-cover scale-105 z-0 hidden dark:block opacity-0 group-hover:opacity-100 group-hover:scale-110 transition-opacity-transform duration-500 ease-in-out"
          >
          <h1 class="font-bold text-2xl text-center relative">🧭 Year 2 (Phase 2)</h1>
        </div>
        <div class="grid grid-cols-2 gap-4 p-8">
          <!-- Semester 1 -->
          <div class="col-span-1">
            <h2 class="font-extrabold text-lg text-center mb-2">Semester 1</h2>
            @for (course of getCourses(2, 1);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>

          <!-- Semester 2 -->
          <div class="col-span-1">
            <h2 class="font-extrabold text-lg text-center mb-2">Semester 2</h2>
            @for (course of getCourses(2, 2);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>

          <!-- Semester 3 -->
          <div class="col-span-2">
            @for (course of getCourses(2, 3);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>
        </div>
      </div>

      <!-- Phase 3 (Year 3) -->
      <div class="bg-bgLightest dark:bg-gray-900 group">
        <div class="p-10 bg-primary text-tertiary dark:bg-secondary relative overflow-hidden transition-colors duration-500 ease-in-out">
          <img
            src="/assets/patterns/checkered-secondary.svg"
            alt="TM Checkered Background"
            class="absolute inset-0 w-full h-full object-cover scale-105 z-0 opacity-0 group-hover:opacity-100 group-hover:scale-110 transition-opacity-transform duration-500 ease-in-out dark:hidden"
          >
          <img
            src="/assets/patterns/circles-dark.svg"
            alt="TM Circles Background"
            class="absolute inset-0 w-full h-full object-cover scale-105 z-0 opacity-0 group-hover:opacity-100 group-hover:scale-110 transition-opacity-transform duration-500 ease-in-out hidden dark:block"
          >
          <h1 class="font-bold text-2xl text-center relative">🚀 Year 3 (Phase 3)</h1>
        </div>
        <div class="grid grid-cols-2 gap-4 p-8">
          <!-- Semester 1 -->
          <div class="col-span-1">
            <h2 class="font-extrabold text-lg text-center mb-2">Semester 1</h2>
            @for (course of getCourses(3, 1);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>

          <!-- Semester 2 -->
          <div class="col-span-1">
            <h2 class="font-extrabold text-lg text-center mb-2">Semester 2</h2>
            @for (course of getCourses(3, 2);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>

          <!-- Semester 3 -->
          <div class="col-span-2">
            @for (course of getCourses(3, 3);track $index) {
              <app-course [course]="course" [isReused]="isReused"
                          [isHighlighted]="isCourseHighlighted(course.learning_track_id, course.z_code)"
                          [isTagIncluded]="isTagIncluded(course.tags)" [selectedTag]="selectedTag()"
                          (courseClick)="onCourseClicked(course.learning_track_id)"></app-course>
            }
          </div>
        </div>
      </div>
    </div>
    @if (!isReused && usedTags.length > 0) {
      <app-footer [usedTags]="usedTags" (tagClick)="onTagClicked($event)"></app-footer>
    }
  }
</div>
